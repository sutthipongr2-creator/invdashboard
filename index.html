<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏•‡∏±‡∏á‡∏¢‡∏≤ 5 ‡∏õ‡∏µ (2564-2568)‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° ‡∏£‡∏û.‡∏ö‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡∏ß</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; margin: 0; padding: 20px; color: #334155; }
        .container { max-width: 1400px; margin: 0 auto; }
        
        .header { 
            background: linear-gradient(135deg, #0f172a, #334155); 
            color: white; 
            padding: 30px; 
            border-radius: 16px; 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); 
            margin-bottom: 25px; 
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header h1 { margin: 0; font-size: 26px; font-weight: 600; }
        .header p { margin: 5px 0 0; opacity: 0.8; font-size: 14px; }
        .badge-year { background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px; font-size: 13px; }

        .card { background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); margin-bottom: 25px; border: 1px solid #e2e8f0; }
        .card-title { font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .card-title::before { content: ''; display: block; width: 4px; height: 20px; background: #3b82f6; border-radius: 2px; }

        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 13px; white-space: nowrap; }
        th { background-color: #f1f5f9; padding: 12px; font-weight: 600; color: #475569; border-bottom: 2px solid #e2e8f0; text-align: center; position: sticky; top: 0; z-index: 10; }
        td { padding: 10px 12px; border-bottom: 1px solid #f1f5f9; vertical-align: middle; }
        tr:hover td { background-color: #f8fafc; }
        
        .col-name { text-align: left; font-weight: 500; color: #0f172a; position: sticky; left: 0; background: white; z-index: 5; border-right: 2px solid #f1f5f9; }
        .col-val { text-align: right; color: #64748b; }
        .col-growth { text-align: center; font-size: 11px; font-weight: 600; }
        .col-current { text-align: right; font-weight: 700; color: #0f172a; background-color: #f0f9ff; }
        
        .trend-up { color: #16a34a; background: #dcfce7; padding: 2px 6px; border-radius: 4px; }
        .trend-down { color: #dc2626; background: #fee2e2; padding: 2px 6px; border-radius: 4px; }
        .trend-neutral { color: #94a3b8; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div>
            <h1>üè• Dashboard ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏•‡∏±‡∏á‡∏¢‡∏≤ 5 ‡∏õ‡∏µ (Top 10 Leaders)‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° ‡∏£‡∏û.‡∏ö‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡∏ß</h1>
            <p>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏õ‡∏µ 2564 - 2568</p>
        </div>
        <div class="badge-year">üìÖ Data: 2564-2568</div>
    </div>

    <div class="card">
        <div class="card-title">üìà ‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£ 5 ‡∏õ‡∏µ (Evolution Chart)</div>
        <div style="height: 500px;">
            <canvas id="trendChart"></canvas>
        </div>
        <p style="text-align: center; font-size: 12px; color: #64748b; margin-top: 10px;">*‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ä‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ó‡∏±‡πâ‡∏á 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
    </div>

    <div class="card">
        <div class="card-title">üìã ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å: ‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏£‡∏≤‡∏¢‡∏õ‡∏µ (Year-over-Year Matrix)</div>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th class="col-name" style="min-width: 200px;">‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤ (Top 10 ‡∏õ‡∏µ 68)</th>
                        <th>‡∏õ‡∏µ 64</th>
                        <th>% YoY</th>
                        <th>‡∏õ‡∏µ 65</th>
                        <th>% YoY</th>
                        <th>‡∏õ‡∏µ 66</th>
                        <th>% YoY</th>
                        <th>‡∏õ‡∏µ 67</th>
                        <th>% YoY</th>
                        <th class="col-current">‡∏õ‡∏µ 68 (‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // --- 1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 5 ‡∏õ‡∏µ (2564-2568) ---
    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå CSV ‡∏à‡∏£‡∏¥‡∏á
    const drugs5Years = [
        { name: "TLD (HIV Drug)", d64: 0, d65: 0, d66: 0, d67: 147403, d68: 125832 },
        { name: "SERETIDE EVOHALER", d64: 33544, d65: 20822, d66: 9244, d67: 21378, d68: 94470 }, // ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î Evohaler ‡∏´‡∏•‡∏≤‡∏¢ code
        { name: "AMLODIPINE 10 MG", d64: 71827, d65: 69231, d66: 67668, d67: 90901, d68: 89789 },
        { name: "TAF + EMTRICITABINE", d64: 0, d65: 0, d66: 0, d67: 23968, d68: 55126 },
        { name: "METFORMIN 500 MG", d64: 67515, d65: 44825, d66: 49856, d67: 37899, d68: 55125 },
        { name: "WINSULIN 70/30", d64: 92715, d65: 47989, d66: 51681, d67: 23191, d68: 54990 },
        { name: "OMEPRAZOLE 20MG", d64: 22440, d65: 16870, d66: 19800, d67: 23760, d68: 53130 },
        { name: "LOSARTAN 50 MG", d64: 49648, d65: 43656, d66: 46894, d67: 71262, d68: 47294 },
        { name: "SIMVASTATIN 20 MG", d64: 32063, d65: 22293, d66: 33319, d67: 40866, d68: 45694 },
        { name: "MMR VACCINE", d64: 0, d65: 0, d66: 0, d67: 26451, d68: 41042 }
    ];

    // --- 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü (Chart.js) ---
    const ctx = document.getElementById('trendChart').getContext('2d');
    const years = ['2564', '2565', '2566', '2567', '2568'];
    
    const colors = [
        '#e11d48', '#ea580c', '#d97706', '#65a30d', '#059669', 
        '#0891b2', '#2563eb', '#4f46e5', '#9333ea', '#db2777'
    ];

    const datasets = drugs5Years.map((d, i) => ({
        label: d.name,
        data: [d.d64, d.d65, d.d66, d.d67, d.d68],
        borderColor: colors[i],
        backgroundColor: colors[i],
        tension: 0.4,
        borderWidth: 2,
        pointRadius: 4,
        pointHoverRadius: 7,
    }));

    new Chart(ctx, {
        type: 'line',
        data: { labels: years, datasets: datasets },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
                mode: 'index', // Key: ‡∏ä‡∏µ‡πâ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÇ‡∏ä‡∏ß‡πå‡∏´‡∏°‡∏î‡∏ó‡∏∏‡∏Å‡πÄ‡∏™‡πâ‡∏ô
                intersect: false, // Key: ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏ô‡∏à‡∏∏‡∏î
            },
            plugins: {
                legend: { position: 'bottom', labels: { usePointStyle: true, boxWidth: 8, padding: 20 } },
                tooltip: {
                    backgroundColor: 'rgba(255, 255, 255, 0.95)',
                    titleColor: '#0f172a',
                    bodyColor: '#334155',
                    borderColor: '#e2e8f0',
                    borderWidth: 1,
                    titleFont: { size: 14, weight: 'bold' },
                    bodyFont: { size: 13 },
                    padding: 12,
                    boxPadding: 4,
                    itemSort: function(a, b) { return b.raw - a.raw; }, // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÉ‡∏ô Tooltip ‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) { label += ': '; }
                            if (context.parsed.y !== null) {
                                label += context.parsed.y.toLocaleString() + ' ‡∏ö‡∏≤‡∏ó';
                            }
                            return label;
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: { color: '#f1f5f9' },
                    ticks: { callback: val => val.toLocaleString() }
                },
                x: { grid: { display: false } }
            }
        }
    });

    // --- 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á ---
    const tbody = document.getElementById('tableBody');
    const calcGrowth = (prev, curr) => {
        if (prev === 0) return curr > 0 ? '<span class="trend-up" style="background:#f0f9ff; color:#0284c7;">New</span>' : '-';
        const pct = ((curr - prev) / prev) * 100;
        const cls = pct > 0 ? 'trend-up' : 'trend-down';
        const icon = pct > 0 ? '‚ñ≤' : '‚ñº';
        if (Math.abs(pct) < 1) return '<span class="trend-neutral">-</span>';
        return `<span class="${cls}">${icon} ${Math.abs(pct).toFixed(0)}%</span>`;
    };

    drugs5Years.forEach(d => {
        const row = `
            <tr>
                <td class="col-name">${d.name}</td>
                <td class="col-val">${d.d64.toLocaleString()}</td>
                <td class="col-growth">${calcGrowth(d.d64, d.d65)}</td>
                <td class="col-val">${d.d65.toLocaleString()}</td>
                <td class="col-growth">${calcGrowth(d.d65, d.d66)}</td>
                <td class="col-val">${d.d66.toLocaleString()}</td>
                <td class="col-growth">${calcGrowth(d.d66, d.d67)}</td>
                <td class="col-val">${d.d67.toLocaleString()}</td>
                <td class="col-growth">${calcGrowth(d.d67, d.d68)}</td>
                <td class="col-current">${d.d68.toLocaleString()}</td>
            </tr>
        `;
        tbody.innerHTML += row;
    });
</script>

</body>
</html>